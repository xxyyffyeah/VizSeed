var S=Object.defineProperty,D=Object.defineProperties;var M=Object.getOwnPropertyDescriptors;var p=Object.getOwnPropertySymbols;var y=Object.prototype.hasOwnProperty,w=Object.prototype.propertyIsEnumerable;var m=(i,e,s)=>e in i?S(i,e,{enumerable:!0,configurable:!0,writable:!0,value:s}):i[e]=s,o=(i,e)=>{for(var s in e||(e={}))y.call(e,s)&&m(i,s,e[s]);if(p)for(var s of p(e))w.call(e,s)&&m(i,s,e[s]);return i},r=(i,e)=>D(i,M(e));import{r as F,e as g}from"./VizSeedCleanupModule-Cwm6WaOq.js";const I=(i,e)=>e.data,L=i=>i.fieldSelection||{dimensions:[],measures:[]},R=(i,e,s,l)=>{i.fieldMap&&(i.fieldMap[l]||(i.fieldMap[l]={id:l,type:s.type,alias:l,location:s.location})),i.fieldSelection&&(i.fieldSelection=e)},_=(i,e,s)=>{var d;const l=I(i,e),n=L(e);if(n.dimensions.length===0)return i;const a=s||n.dimensions[0];if(!n.dimensions.includes(a))throw new Error(`维度字段 ${a} 不存在于当前字段选择中`);const t=`${a}_copy`,u=l.map(f=>r(o({},f),{[t]:f[a]})),h={dimensions:[...n.dimensions,t],measures:[...n.measures]},c=(d=e.fieldMap)==null?void 0:d[a];return R(e,h,c,t),e.data=u,r(o({},i),{data:e.data,fieldSelection:e.fieldSelection,fieldMap:e.fieldMap,copyInfo:{type:"dimension",originalField:a,copiedField:t}})},k=(i,e)=>{if(e.fieldSelection.dimensions.length===2&&e.fieldSelection.measures.length===1)return r(o({},i),{data:e.data,reshapeInfo:{steps:[]}});const n=[];if(e.fieldSelection.dimensions.length>0){let a=e.fieldSelection.dimensions.length;for(;a>1;){i=F(i,e);const t=e.fieldSelection.dimensions.length;if(t>=a)break;a=t,n.push("reduce")}e.fieldSelection.measures.length>=1&&(i=g(i,e),n.push("elevate"))}else e.fieldSelection.measures.length>=1&&(i=g(i,e),n.push("elevate")),e.fieldSelection.dimensions.length>0&&e.fieldSelection.dimensions.length<2&&(i=_(i,e),n.push("copyDimension"));return r(o({},i),{data:e.data,reshapeInfo:{steps:n}})};export{k as d};
//# sourceMappingURL=DataReshapeModule_1M1D1G-AC0bMyre.js.map
