{"version":3,"file":"PipelineCore-BG5ZN1GD.js","sources":["../../src/pipeline/PipelineCore.ts"],"sourcesContent":["/**\n * Pipeline 核心类型和工具函数\n * 简化的函数式管道处理系统\n */\n\nimport { NestedMeasure } from \"../types\";\nimport { ChartType, ChannelMapping } from \"../types/charts\";\n\n// 字段定义接口\nexport interface FieldDefinition {\n  id: string;\n  type: 'string' | 'number' | 'float' | 'date' | 'boolean';\n  alias: string;\n  location: 'dimension' | 'measure' | 'tooltips';\n  domain?: any[];\n  format?: Record<string, any>;\n}\n\n// 完整字段映射接口\nexport interface FieldMap {\n  [fieldId: string]: FieldDefinition;\n}\n\n// 用户字段选择接口\nexport interface FieldSelection {\n  dimensions: string[];  // 用户选择的维度字段ID\n  measures: string[];    // 用户选择的指标字段ID\n  groupMeasure?: NestedMeasure<string>[]; // 可选的分组指标字段ID\n  rowDimensions?: string[];  // 行维度字段（用于透视表等）\n  columnDimensions?: string[];  // 列维度字段（用于透视表等）\n}\n\n// Pipeline上下文接口\nexport interface PipelineContext {\n  chartType: ChartType; // 图表类型\n  encodes: ChannelMapping[]; // 映射通道配置\n  fieldMap: FieldMap;        // 完整字段映射定义\n  fieldSelection: FieldSelection;  // 用户字段选择\n  data: Record<string, any>[]; // 数据映射数组\n  visualStyle?: any;\n  \n  // 维度重塑相关\n  analysisResult?: any;       // 图表适配分析结果\n  theme: 'light' | 'dark' | 'custom'; // 主题配置\n  version: string; // 版本信息\n  [key: string]: any;\n}\n\n// Pipeline管道函数类型 - 简化为纯函数\nexport type PipelineStep<T = any> = (input: T, context: PipelineContext) => T;\n\n// 简化的管道函数工厂 - 使用reduce实现函数式组合\nexport const pipeline = <T>(steps: PipelineStep<T>[], initialValue: T) => {\n  return (context: PipelineContext) => {\n    return steps.reduce((result, step) => {\n      return step(result, context);\n    }, initialValue);\n  };\n};\n\n"],"names":["pipeline","steps","initialValue","context","result","step"],"mappings":"AAoDO,MAAMA,EAAW,CAAIC,EAA0BC,IAC5CC,GACCF,EAAM,OAAO,CAACG,EAAQC,IACpBA,EAAKD,EAAQD,CAAO,EAC1BD,CAAY"}